<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

<button id="AllPost">Mostrar Tudo</button>

<form id="myForm" action="">
    <input id="myFile" type="file">
    <button type="submit">Click</button>
</form>

<div id="feed">

</div>

    <script>
        const myForm = document.getElementById("myForm")
        myForm.addEventListener("submit", (event) =>{
            event.preventDefault()

            const myFile = document.getElementById("myFile")
            readFile(myFile)
            }
        )
        function readFile(file){
            const reader = new FileReader()
            reader.onload = (e) =>{
                const post = {
                    description: "aaaaaaaaaaa",
                    image: e.target.result  
                }
                savePost(post)
            }
        }

        // const btn = document.querySelector("#enviar")
        // btn.addEventListener("click", () =>{
        //     post = {
        //         "description": "Alguma coisa"
        //     }

        //     savePost(post)
        //     readPost(post)
        // })

        const btn_all = document.querySelector("#AllPost")
        btn_all.addEventListener("click", () =>{
            readAll()
        })

        function savePost(post){
            if (!localStorage.getItem("posts")){
                localStorage.setItem("posts", JSON.stringify([]))
            }
            else{
                let posts = localStorage.getItem("posts")
                posts = JSON.parse(posts)
                posts.push(post)
                localStorage.setItem("posts", JSON.stringify(posts))
            }
        }
        
        function readPost(post){
            const feed = document.getElementById("feed")
            let p = document.createElement("p")
            let image = document.createElement("img")
            p.innerText = post.description
            image.src = post.urlImage
            feed.appendChild(p)
        }

        function readAll(){
            const posts = JSON.parse(localStorage.getItem("posts")) || []

            for (let p of posts)
            {
                readPost(p)
            }
        }
    </script>
</body>
</html>